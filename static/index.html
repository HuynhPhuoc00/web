<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Điều khiển đèn IoT</title>
</head>
<body>
    <h1>Đèn phòng khách</h1>
    <label>
        <input type="checkbox" id="example_01"> Bật/Tắt đèn
    </label>
    <br><br>
    <img id="d01_img" src="./img/dentat.png" width="200px">

    <script>
    const btn1 = document.getElementById("example_01");
    btn1.onclick = function(){
        const isChecked = btn1.checked;
        document.getElementById("d01_img").src = isChecked ? "./img/densang.png" : "./img/dentat.png";
        fetch("/bulb", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ "BULB_01": isChecked ? "ON" : "OFF" })
        });
    };

    window.onload = () => {
        fetch("/bulb")
            .then(res => res.json())
            .then(data => {
                const isOn = data.BULB_01 === "ON";
                btn1.checked = isOn;
                document.getElementById("d01_img").src = isOn ? "./img/densang.png" : "./img/dentat.png";
            });
    };
    </script>
</body>
</html>
